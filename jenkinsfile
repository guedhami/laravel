pipeline {
    agent any 
 

    stages {
        stage('Clone repository') {
            steps {
                script {
                    // Checkout the Laravel repository
                    checkout([$class: 'GitSCM', branches: [[name: '*/main']], userRemoteConfigs: [[credentialsId: 'git', url: 'https://github.com/guedhami/laravel']]])
                }
            }
        }

      stage('Build and Push Docker Image') {
    steps {
        withCredentials([usernamePassword(credentialsId: 'docker', usernameVariable: 'hayder69', passwordVariable: 'DOCKERHUB_Pdckr_pat_uQfuQ234dHKEE0vbdTISPMIymPQASSWORD')]) {
            sh '''
                # Use DOCKERHUB_USERNAME and DOCKERHUB_PASSWORD in your Docker commands
                docker login -u $hayder69 -p $dckr_pat_uQfuQ234dHKEE0vbdTISPMIymPQ
                docker build -t test-jenkins .
                docker push test-jenkins
            '''
        }
    }
      }
    }
}
